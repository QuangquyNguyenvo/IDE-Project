<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C++ IDE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&family=Nunito:wght@400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/suggest-fix.css">
    <link rel="stylesheet" href="styles/snippet-editor.css">
    <link rel="stylesheet" href="styles/themes.css">
    <link rel="stylesheet" href="../node_modules/monaco-editor/min/vs/editor/editor.main.css">
</head>

<body>
    <div class="app-container">

        <!-- ===== HEADER ===== -->
        <div class="header-bar">
            <div class="logo">C++</div>

            <!-- Hamburger menu for small screens -->
            <button class="hamburger-btn" id="btn-hamburger" title="Menu">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                    <path d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>

            <div class="menu-group" id="menu-group">
                <button class="menu-btn" data-menu="file">File</button>
                <button class="menu-btn" data-menu="edit">Edit</button>
                <button class="menu-btn" data-menu="view">View</button>
                <button class="menu-btn" data-menu="run">Run</button>
            </div>

            <div class="tabs-wrap">
                <div class="tabs-container" id="tabs-container"></div>
                <button class="tab-add" id="btn-new-tab" title="New File (Ctrl+N)">+</button>
            </div>

            <div class="header-actions">
                <!-- Toggle buttons -->
                <button class="toggle-btn" id="btn-toggle-io" title="Hiện Input/Expected">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                        stroke-linejoin="round">
                        <rect x="3" y="3" width="7" height="8" rx="1.5" />
                        <rect x="3" y="13" width="7" height="8" rx="1.5" />
                        <path d="M14 7h6M14 12h4M14 17h5" />
                    </svg>
                </button>
                <button class="toggle-btn active" id="btn-toggle-term" title="Hiện Terminal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M4 17l6-5-6-5" />
                        <path d="M12 19h8" />
                    </svg>
                </button>
                <button class="toggle-btn" id="btn-toggle-problems" title="Hiện khung lỗi (Ctrl+J)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 8v4M12 16h.01" />
                    </svg>
                </button>
                <button class="toggle-btn" id="btn-cc" title="Lấy test case tự động từ OJ">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2" />
                        <rect x="9" y="3" width="6" height="4" rx="1" />
                        <path d="M9 12l2 2 4-4" />
                    </svg>
                </button>

                <span class="sep"></span>

                <!-- Run buttons -->
                <button class="action-btn primary" id="btn-buildrun" title="Biên dịch và chạy (F11)">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                    <span>Run</span>
                </button>
                <button class="action-btn" id="btn-run-only" title="Chỉ chạy (F10)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M5 4l12 8-12 8V4z" />
                    </svg>
                </button>
                <button class="action-btn danger" id="btn-stop" title="Dừng chương trình" disabled>
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <rect x="5" y="5" width="14" height="14" rx="2" />
                    </svg>
                </button>

                <span class="sep"></span>

                <!-- Settings button -->
                <button class="toggle-btn" id="btn-settings" title="Cài đặt (Ctrl+,)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" />
                    </svg>
                </button>
            </div>

            <span class="sep"></span>

            <!-- Windows buttons -->
            <div class="win-btns">
                <button class="win-btn" id="btn-min" title="Minimize">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14" />
                    </svg>
                </button>
                <button class="win-btn" id="btn-max" title="Maximize">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="5" y="5" width="14" height="14" rx="2" />
                    </svg>
                </button>
                <button class="win-btn close" id="btn-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 6l12 12M18 6L6 18" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Dropdowns -->
        <div class="dropdown" id="menu-file">
            <div class="dropdown-item" data-action="new"><span>New File</span><span class="key">Ctrl+N</span></div>
            <div class="dropdown-item" data-action="open"><span>Open</span><span class="key">Ctrl+O</span></div>
            <div class="dropdown-item" data-action="save"><span>Save</span><span class="key">Ctrl+S</span></div>
            <div class="dropdown-sep"></div>
            <div class="dropdown-item" data-action="exit"><span>Exit</span></div>
        </div>
        <div class="dropdown" id="menu-edit">
            <div class="dropdown-item" data-action="undo"><span>Undo</span><span class="key">Ctrl+Z</span></div>
            <div class="dropdown-item" data-action="redo"><span>Redo</span><span class="key">Ctrl+Y</span></div>
            <div class="dropdown-sep"></div>
            <div class="dropdown-item" data-action="find"><span>Find</span><span class="key">Ctrl+F</span></div>
        </div>
        <div class="dropdown" id="menu-view">
            <div class="dropdown-item" data-action="toggleio"><span>Input/Output</span></div>
            <div class="dropdown-item" data-action="toggleterm"><span>Terminal</span></div>
            <div class="dropdown-item" data-action="toggleproblems"><span>Problems</span><span class="key">Ctrl+J</span>
            </div>
            <div class="dropdown-sep"></div>
            <div class="dropdown-item" data-action="spliteditor"><span>Split</span><span class="key">Ctrl+\</span></div>
            <div class="dropdown-item" data-action="swapsplit"><span>Swap</span><span class="key">Ctrl+⇧+\</span></div>
            <div class="dropdown-item" data-action="closesplit"><span>Close Split</span></div>
            <div class="dropdown-sep"></div>
            <div class="dropdown-item" data-action="settings"><span>Settings</span><span class="key">Ctrl+,</span></div>
        </div>
        <div class="dropdown" id="menu-run">
            <div class="dropdown-item" data-action="buildrun"><span>Build & Run</span><span class="key">F11</span></div>
            <div class="dropdown-item" data-action="run"><span>Run</span><span class="key">F10</span></div>
            <div class="dropdown-sep"></div>
            <div class="dropdown-item" data-action="stop"><span>Stop</span><span class="key">Shift+F5</span></div>
        </div>

        <!-- ===== COMPETITIVE COMPANION POPUP ===== -->
        <div class="cc-overlay" id="cc-overlay">
            <div class="cc-popup">
                <div class="cc-header">
                    <h2>
                        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <path
                                d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z" />
                        </svg>
                        Lấy test từ OJ
                    </h2>
                    <button class="cc-close" id="cc-close">×</button>
                </div>
                <div class="cc-body">
                    <div class="cc-steps">
                        <div class="cc-step">
                            <span class="cc-step-num">1</span>
                            <span class="cc-step-text">Cài extension <strong>Competitive Companion</strong> vào
                                Chrome/Firefox</span>
                        </div>
                        <div class="cc-step">
                            <span class="cc-step-num">2</span>
                            <span class="cc-step-text">Mở bài tập trên trang OJ bất kỳ</span>
                        </div>
                        <div class="cc-step">
                            <span class="cc-step-num">3</span>
                            <span class="cc-step-text">Click icon <strong>+</strong> của extension trên trình
                                duyệt</span>
                        </div>
                        <div class="cc-step">
                            <span class="cc-step-num">4</span>
                            <span class="cc-step-text">Test cases sẽ <strong>tự động tải</strong> vào IDE!</span>
                        </div>
                    </div>
                </div>
                <div class="cc-footer">
                    <button class="cc-btn secondary" id="cc-cancel">Đóng</button>
                    <button class="cc-btn primary" id="cc-install">Cài Extension</button>
                </div>
            </div>
        </div>

        <!-- ===== UPDATE NOTIFICATION POPUP ===== -->
        <div class="update-overlay" id="update-overlay">
            <div class="update-popup">
                <div class="update-header">
                    <h2>
                        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" />
                        </svg>
                        Có phiên bản mới!
                    </h2>
                    <button class="update-close" id="update-close">×</button>
                </div>
                <div class="update-body">
                    <div class="update-version">
                        <span class="update-current" id="update-current">v1.0.0</span>
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                        <span class="update-new" id="update-new">v1.0.1</span>
                    </div>
                    <div class="update-notes" id="update-notes">
                        <!-- Release notes will be inserted here -->
                    </div>
                </div>
                <div class="update-footer">
                    <button class="update-btn secondary" id="update-later">Để sau</button>
                    <button class="update-btn primary" id="update-download">
                        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" />
                        </svg>
                        Tải về ngay
                    </button>
                </div>
            </div>
        </div>

        <!-- ===== SETTINGS POPUP ===== -->
        <div class="settings-overlay" id="settings-overlay">
            <div class="settings-popup" id="settings-popup">
                <div class="settings-header">
                    <h2><svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3" />
                            <path
                                d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" />
                        </svg> Settings</h2>
                    <button class="settings-close" id="settings-close">×</button>
                </div>

                <div class="settings-container">
                    <!-- Sidebar Tabs -->
                    <div class="settings-sidebar">
                        <button class="settings-tab active" data-tab="editor">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 20h9M16.5 3.5a2.12 2.12 0 013 3L7 19l-4 1 1-4L16.5 3.5z" />
                            </svg>
                            Editor
                        </button>
                        <button class="settings-tab" data-tab="compiler">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z" />
                            </svg>
                            Compiler
                        </button>
                        <button class="settings-tab" data-tab="execution">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polygon points="5 3 19 12 5 21 5 3" />
                            </svg>
                            Execution
                        </button>
                        <button class="settings-tab" data-tab="appearance">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="3" />
                                <path
                                    d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                            </svg>
                            Appearance
                        </button>
                        <button class="settings-tab" data-tab="template">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" />
                                <polyline points="14 2 14 8 20 8" />
                                <line x1="16" y1="13" x2="8" y2="13" />
                                <line x1="16" y1="17" x2="8" y2="17" />
                            </svg>
                            Template
                        </button>
                        <button class="settings-tab" data-tab="keybindings">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="2" y="4" width="20" height="16" rx="2" ry="2" />
                                <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M8 12h.01M12 12h.01M16 12h.01M7 16h10" />
                            </svg>
                            Keybindings
                        </button>
                        <button class="settings-tab" data-tab="snippets">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="16 18 22 12 16 6" />
                                <polyline points="8 6 2 12 8 18" />
                            </svg>
                            Snippets
                        </button>
                    </div>

                    <!-- Tab Content -->
                    <div class="settings-content">
                        <!-- Editor Tab -->
                        <div class="settings-panel active" id="panel-editor">
                            <h3>Editor Settings</h3>
                            <div class="setting-row">
                                <label>Font Size</label>
                                <div class="setting-control">
                                    <input type="range" id="set-fontSize" min="10" max="24" value="14">
                                    <span class="setting-value" id="val-fontSize">14px</span>
                                </div>
                            </div>
                            <div class="setting-row">
                                <label>Font Family</label>
                                <select id="set-fontFamily">
                                    <option value="'JetBrains Mono', monospace">JetBrains Mono</option>
                                    <option value="'Fira Code', monospace">Fira Code</option>
                                    <option value="Consolas, monospace" selected>Consolas</option>
                                    <option value="'Cascadia Code', monospace">Cascadia Code</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label>Tab Size</label>
                                <select id="set-tabSize">
                                    <option value="2">2 spaces</option>
                                    <option value="4" selected>4 spaces</option>
                                    <option value="8">8 spaces</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label>Minimap</label>
                                <label class="switch">
                                    <input type="checkbox" id="set-minimap">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-row">
                                <label>Word Wrap</label>
                                <label class="switch">
                                    <input type="checkbox" id="set-wordWrap">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-row">
                                <label>Keyword Suggestions <span class="tooltip"
                                        title="Suggest keywords like vector, cout, int...">?</span></label>
                                <label class="switch">
                                    <input type="checkbox" id="set-keywords" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-row">
                                <label>Editor Colors <span class="tooltip"
                                        title="Syntax highlighting color scheme">?</span></label>
                                <select id="set-editorColorScheme">
                                    <option value="auto">Auto (Match Theme)</option>
                                    <option value="kawaii-dark">Kawaii Dark</option>
                                    <option value="kawaii-light">Kawaii Light</option>
                                    <option value="sakura">Sakura</option>
                                    <option value="dracula">Dracula</option>
                                    <option value="monokai">Monokai</option>
                                    <option value="nord">Nord</option>
                                    <option value="one-dark">One Dark</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label>Auto Save <span class="tooltip"
                                        title="Automatically save files after you stop typing">?</span></label>
                                <div class="setting-control">
                                    <label class="switch">
                                        <input type="checkbox" id="set-autoSave">
                                        <span class="slider"></span>
                                    </label>
                                    <input type="number" id="set-autoSaveDelay" min="1" max="30" value="3"
                                        style="width:60px;margin-left:10px;text-align:center">
                                    <span>sec</span>
                                </div>
                            </div>
                            <div class="setting-row">
                                <label>Live Code Checking <span class="tooltip"
                                        title="Check for errors automatically while typing">?</span></label>
                                <div class="setting-control">
                                    <label class="switch">
                                        <input type="checkbox" id="set-liveCheck">
                                        <span class="slider"></span>
                                    </label>
                                    <input type="number" id="set-liveCheckDelay" min="500" max="5000" value="1000"
                                        style="width:90px;margin-left:10px;text-align:center">
                                    <span>ms</span>
                                </div>
                            </div>
                            <div class="setting-row">
                                <label>Intellisense (Code Suggestions) <span class="tooltip"
                                        title="Enable smart code completion for C++">?</span></label>
                                <label class="switch">
                                    <input type="checkbox" id="set-intellisense">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- Compiler Tab -->
                        <div class="settings-panel" id="panel-compiler">
                            <h3>Compiler Settings</h3>
                            <div class="setting-row">
                                <label>C++ Standard</label>
                                <select id="set-cppStandard">
                                    <option value="">Default</option>
                                    <option value="c++11">C++11</option>
                                    <option value="c++14">C++14</option>
                                    <option value="c++17">C++17</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label>Optimization <span class="tooltip"
                                        title="None: Fast build, easy debug&#10;Fast: 2-3x faster runtime&#10;Fastest: Maximum speed">?</span></label>
                                <select id="set-optimization">
                                    <option value="" selected>None (-O0)</option>
                                    <option value="-O2">Fast (-O2)</option>
                                    <option value="-O3">Fastest (-O3)</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label>Warnings <span class="tooltip"
                                        title="Enable -Wall -Wextra for potential issues">?</span></label>
                                <label class="switch">
                                    <input type="checkbox" id="set-warnings" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- Execution Tab -->
                        <div class="settings-panel" id="panel-execution">
                            <h3>Execution Settings</h3>
                            <div class="setting-row">
                                <label>Time Limit <span class="tooltip"
                                        title="Auto-stop after X seconds&#10;Disable for games/long-running programs">?</span></label>
                                <div class="setting-control">
                                    <label class="switch">
                                        <input type="checkbox" id="set-timeLimitEnabled">
                                        <span class="slider"></span>
                                    </label>
                                    <input type="number" id="set-timeLimitSeconds" min="1" max="60" value="3"
                                        style="width:60px;margin-left:10px">
                                    <span>sec</span>
                                </div>
                            </div>
                            <div class="setting-row">
                                <label>Clear Terminal on Run</label>
                                <label class="switch">
                                    <input type="checkbox" id="set-clearTerminal" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-row">
                                <label>Auto-send Input</label>
                                <label class="switch">
                                    <input type="checkbox" id="set-autoSendInput" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-row">
                                <label>Terminal Colors <span class="tooltip"
                                        title="ANSI 16: Show colored output&#10;Disabled: Plain text only">?</span></label>
                                <select id="set-terminalColorScheme">
                                    <option value="ansi-16" selected>ANSI 16 Colors</option>
                                    <option value="ansi-256">ANSI 256 Colors</option>
                                    <option value="dracula">Dracula</option>
                                    <option value="monokai">Monokai</option>
                                    <option value="nord">Nord</option>
                                    <option value="solarized">Solarized Dark</option>
                                    <option value="disabled">Disabled (Plain)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Appearance Tab with Preview -->
                        <div class="settings-panel" id="panel-appearance">
                            <div class="appearance-layout">
                                <div class="appearance-controls">
                                    <h3>Theme</h3>
                                    <div class="setting-row">
                                        <label>Color Theme</label>
                                        <select id="set-theme">
                                            <option value="kawaii-dark">Kawaii Dark</option>
                                            <option value="kawaii-light">Kawaii Light</option>
                                            <option value="sakura">Sakura</option>
                                            <option value="dracula">Dracula</option>
                                            <option value="monokai">Monokai</option>
                                            <option value="nord">Nord</option>
                                            <option value="one-dark">One Dark Pro</option>
                                        </select>
                                    </div>

                                    <h3 style="margin-top:20px">Background</h3>
                                    <div class="setting-row">
                                        <label>Opacity</label>
                                        <div class="setting-control">
                                            <input type="range" id="set-bgOpacity" min="20" max="90" value="50">
                                            <span class="setting-value" id="val-bgOpacity">50%</span>
                                        </div>
                                    </div>

                                    <h3 style="margin-top:20px">Options</h3>
                                    <div class="setting-row">
                                        <label>Performance Mode</label>
                                        <label class="switch">
                                            <input type="checkbox" id="set-performanceMode">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Enhanced Live Preview -->
                                <div class="appearance-preview">
                                    <div class="preview-label">Live Preview</div>
                                    <div class="preview-window" id="theme-preview">
                                        <!-- Header with tabs -->
                                        <div class="preview-header">
                                            <span class="preview-dot red"></span>
                                            <span class="preview-dot yellow"></span>
                                            <span class="preview-dot green"></span>
                                            <span class="preview-tab active">main.cpp</span>
                                        </div>

                                        <!-- Main content area -->
                                        <div class="preview-body">
                                            <!-- Editor section -->
                                            <div class="preview-editor">
                                                <div class="preview-line"><span class="ln">1</span><span
                                                        class="kw">#include</span> <span
                                                        class="str">&lt;iostream&gt;</span></div>
                                                <div class="preview-line"><span class="ln">2</span><span
                                                        class="kw">using</span> std;</div>
                                                <div class="preview-line"><span class="ln">3</span></div>
                                                <div class="preview-line"><span class="ln">4</span><span
                                                        class="type">int</span> <span class="fn">main</span>() {</div>
                                                <div class="preview-line"><span class="ln">5</span> cout << <span
                                                        class="str">"Hi"</span>;</div>
                                                <div class="preview-line"><span class="ln">6</span>}</div>
                                            </div>

                                            <!-- IO panels -->
                                            <div class="preview-io-section">
                                                <div class="preview-io-panel">
                                                    <div class="preview-io-header">INPUT</div>
                                                    <div class="preview-io-body">5</div>
                                                </div>
                                                <div class="preview-io-panel">
                                                    <div class="preview-io-header">EXPECTED</div>
                                                    <div class="preview-io-body">Hi</div>
                                                </div>
                                            </div>

                                            <!-- Terminal section -->
                                            <div class="preview-terminal">
                                                <div class="preview-term-header">TERMINAL</div>
                                                <div class="preview-term-content">
                                                    <span class="term-success">✓ Build OK</span><br>
                                                    <span class="term-output">Hi</span><br>
                                                    <span class="term-info">Exit: 0</span>
                                                </div>
                                                <div class="preview-term-input">
                                                    <span class="term-prompt">&gt;</span>
                                                    <span class="term-cursor">_</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Status bar -->
                                        <div class="preview-statusbar">
                                            <span class="status-dot"></span>
                                            <span>Ready</span>
                                            <span class="status-right">Ln 1, Col 1</span>
                                        </div>
                                    </div>

                                    <!-- Image URL and Upload below preview -->
                                    <div class="preview-bg-controls">
                                        <div class="bg-control-row">
                                            <label>Image URL</label>
                                            <input type="text" id="set-bgUrl" placeholder="https://..."
                                                class="bg-url-input">
                                        </div>
                                        <div class="bg-control-buttons">
                                            <label class="btn-upload">
                                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                                                </svg>
                                                Upload
                                                <input type="file" id="set-bgFile" accept="image/*"
                                                    style="display:none">
                                            </label>
                                            <button class="btn-reset-bg" id="btn-reset-bg">Reset</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Template Tab -->
                        <div class="settings-panel" id="panel-template">
                            <h3>Code Template</h3>
                            <p class="setting-desc">Template code for new files. Use this as your starting point.</p>
                            <div class="template-editor">
                                <div id="template-editor-container"></div>
                                <textarea id="set-template" style="display:none"></textarea>
                            </div>
                            <div class="template-actions">
                                <button class="btn-template-reset" id="btn-template-reset">Reset to Default</button>
                            </div>
                        </div>

                        <!-- Keybindings Tab -->
                        <div class="settings-panel" id="panel-keybindings">
                            <h3>Keyboard Shortcuts</h3>
                            <p class="setting-desc">Click on a shortcut to change it. Press Escape to cancel.</p>
                            <div class="keybindings-list" id="keybindings-list">
                                <!-- Keybindings will be rendered by JS -->
                            </div>
                            <div class="keybindings-actions">
                                <button class="btn-keybindings-reset" id="btn-keybindings-reset">Reset to
                                    Defaults</button>
                            </div>
                        </div>

                        <!-- Snippets Tab -->
                        <div class="settings-panel" id="panel-snippets">
                            <h3>Code Snippets</h3>
                            <p class="setting-desc">
                                Create shortcuts for frequently used code. Type the trigger keyword in the editor to
                                insert your snippet.
                            </p>

                            <!-- Enable toggle -->
                            <div class="setting-row" style="margin-bottom: 15px;">
                                <label>Enable Snippets <span class="tooltip"
                                        title="Show snippet suggestions when typing">?</span></label>
                                <label class="switch">
                                    <input type="checkbox" id="set-snippets-enabled" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="setting-group" style="display: block;">
                                <div class="snippets-list-container">
                                    <div id="snippets-list"></div>
                                </div>
                                <button id="btn-add-snippet">
                                    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <line x1="12" y1="5" x2="12" y2="19" />
                                        <line x1="5" y1="12" x2="19" y2="12" />
                                    </svg>
                                    Add New Snippet
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-footer">
                    <button class="btn-reset" id="btn-reset-settings">Reset to Defaults</button>
                    <button class="btn-save" id="btn-save-settings">Save & Close</button>
                </div>
            </div>
        </div>

        <!-- ===== SNIPPET EDITOR MODAL ===== -->
        <div class="snippet-editor-modal" id="snippet-editor-modal">
            <div class="snippet-editor-overlay"></div>
            <div class="snippet-editor-container">
                <div class="snippet-editor-header">
                    <h2 id="snippet-editor-title">Edit Snippet</h2>
                    <button class="btn-close-snippet-editor" id="btn-close-snippet-editor">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <div class="snippet-editor-body">
                    <div class="snippet-field">
                        <label for="snippet-trigger-input">Trigger Keyword</label>
                        <input type="text" id="snippet-trigger-input" placeholder="e.g., fori, bfs, dfs..." />
                    </div>
                    <div class="snippet-field">
                        <label for="snippet-content-editor">Snippet Content</label>
                        <div id="snippet-content-editor"
                            style="height: 300px; border: 1px solid var(--border-color); border-radius: 6px; background: #1e1e1e;">
                        </div>
                    </div>
                    <!-- Snippet Tips -->
                    <div class="snippet-tips">
                        <div class="tips-header">
                            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                            Mẹo viết Snippet (Smart Template)
                        </div>
                        <div class="tips-content">
                            • <code>${1:ten_bien}</code> : Điểm dừng số 1, nhấn Tab để nhảy tới đây. Có nội dung mặc
                            định.<br>
                            • <code>${2}</code> : Điểm dừng số 2, nhấn Tab lần nữa để tới đây.<br>
                            • <code>${0}</code> : Điểm dừng cuối cùng (thường để giữa cặp ngoặc { }).
                            <div class="tips-examples">
                                <strong>Ví dụ:</strong><br>
                                1. Vòng lặp:
                                <pre>for(int i=0; i<${1:n}; i++) {\n    ${0}\n}</pre>
                                2. Xuất dữ liệu / Vector:
                                <pre>cout<<${1:res}<<"\\n";\nvector<${1:int}> ${2:v};</pre>
                                3. Viết hàm nhanh:
                                <pre>${1:void} ${2:solve}() {\n    ${0}\n}</pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="snippet-editor-footer">
                    <button class="btn-secondary" id="btn-cancel-snippet">Cancel</button>
                    <button class="btn-primary" id="btn-save-snippet">Save Snippet</button>
                </div>
            </div>
        </div>


        <!-- ===== MAIN ===== -->
        <div class="main">
            <!-- Welcome -->
            <div class="welcome" id="welcome">
                <div class="welcome-box">
                    <h1>C++ IDE</h1>
                    <p>Fast & Modern Development</p>
                    <div class="welcome-btns">
                        <button class="welcome-btn" id="welcome-new">
                            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2.5">
                                <path d="M12 5v14M5 12h14" />
                            </svg>
                            New File
                        </button>
                        <button class="welcome-btn" id="welcome-open">
                            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2.5">
                                <path d="M3 7h4l2 2h8a2 2 0 012 2v7a2 2 0 01-2 2H5a2 2 0 01-2-2V7z" />
                            </svg>
                            Open File
                        </button>
                    </div>
                </div>
            </div>

            <!-- Editor Section with Split support -->
            <div class="editor-section" id="editor-section" style="display:none">
                <div class="editors-container" id="editors-container">
                    <!-- Primary Editor -->
                    <div class="editor-pane" id="editor-pane-1">
                        <div class="editor-area" id="editor-area">
                            <div id="editor-container"></div>
                        </div>
                    </div>

                    <!-- Split Resizer (hidden by default) -->
                    <div class="resizer-split" id="resizer-split" style="display:none"></div>

                    <!-- Secondary Editor (hidden by default) -->
                    <div class="editor-pane" id="editor-pane-2" style="display:none">
                        <div class="editor-area" id="editor-area-2">
                            <div id="editor-container-2"></div>
                        </div>
                    </div>
                </div>

                <div class="resizer-h" id="resizer-problems"></div>

                <div class="problems-panel hidden" id="problems-panel">
                    <div class="panel-head">
                        <span class="panel-title problems active" data-panel="problems">PROBLEMS</span>
                        <span class="problem-count" id="problem-count">0</span>
                        <span class="panel-title tests" data-panel="tests">TESTS</span>
                        <span class="test-count" id="test-results-count" style="display:none">0/0</span>
                        <button class="run-all-btn" id="btn-run-all-tests" title="Chạy tất cả test (Ctrl+Shift+F11)"
                            style="display:none">
                            <svg viewBox="0 0 24 24" width="12" height="12" fill="currentColor">
                                <polygon points="5 3 19 12 5 21 5 3" />
                            </svg>
                            Run All
                        </button>
                        <button class="panel-close" id="close-problems" title="Hide">×</button>
                    </div>
                    <div class="problems-body" id="problems-list"></div>
                    <div class="tests-results-body" id="tests-results-list" style="display:none"></div>
                </div>
            </div>

            <div class="resizer" id="resizer-io"></div>

            <div class="io-section" id="io-section">
                <div class="io-panel">
                    <div class="panel-head">
                        <span class="panel-title input">INPUT</span>
                        <!-- Test case navigation (hidden by default, shown when problem loaded) -->
                        <div class="test-nav" id="test-nav" style="display:none">
                            <button class="test-nav-btn" id="btn-add-test" title="Thêm test case mới">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor"
                                    stroke-width="3">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                            </button>
                            <button class="test-nav-btn" id="btn-prev-test" title="Test trước">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor"
                                    stroke-width="3">
                                    <polyline points="15 18 9 12 15 6" />
                                </svg>
                            </button>
                            <span class="test-nav-label" id="test-nav-label">1/1</span>
                            <button class="test-nav-btn" id="btn-next-test" title="Test tiếp theo">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor"
                                    stroke-width="3">
                                    <polyline points="9 18 15 12 9 6" />
                                </svg>
                            </button>
                            <button class="test-nav-btn danger" id="btn-delete-test" title="Xóa test case này">
                                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor"
                                    stroke-width="3">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path
                                        d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                    </path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <textarea class="panel-textarea" id="input-area" placeholder="Nhập dữ liệu test..."></textarea>
                </div>
                <div class="io-panel">
                    <div class="panel-head">
                        <span class="panel-title output">EXPECTED</span>
                    </div>
                    <textarea class="panel-textarea" id="expected-area" placeholder="Kết quả mong đợi..."></textarea>
                    <div class="diff-display" id="expected-diff" style="display:none"></div>
                </div>
            </div>

            <div class="resizer" id="resizer-term"></div>

            <div class="terminal-section" id="terminal-section">
                <div class="panel-head">
                    <span class="panel-title terminal">TERMINAL</span>
                    <button class="clear-btn" id="clear-term" title="Clear">
                        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" />
                        </svg>
                    </button>
                </div>
                <div class="terminal-body" id="terminal"></div>
                <div class="terminal-input">
                    <span class="prompt">
                        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor"
                            stroke-width="2.5">
                            <path d="M9 18l6-6-6-6" />
                        </svg>
                    </span>
                    <textarea id="terminal-in" rows="1" placeholder="Input..." disabled></textarea>
                    <button class="send-btn" id="btn-send" disabled title="Send">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar" id="status-bar">
            <div class="status-left">
                <span class="status-item" id="status"><span class="dot"></span>Ready</span>
            </div>
            <div class="status-right">
                <span class="status-item" id="cursor-pos">Ln 1, Col 1</span>
                <span class="status-item">C++</span>
            </div>
        </div>

    </div>

    <script>var require = { paths: { vs: '../node_modules/monaco-editor/min/vs' } };</script>
    <script src="../node_modules/monaco-editor/min/vs/loader.js"></script>
    <script src="js/cpp-suggestions.js"></script>
    <script src="js/snippet-editor.js"></script>
    <script src="js/ui/theme-manager.js"></script>
    <script src="js/app.js"></script>
</body>

</html>